Menu="OtherSettings:UnraidClaw"
Title="Activity Log"
---
<?PHP
$plugin = "openclaw-connect";
$logFile = "/boot/config/plugins/{$plugin}/activity.jsonl";
?>

<link rel="stylesheet" type="text/css" href="/plugins/<?=$plugin?>/css/openclaw-connect.css?v=<?=filemtime("/usr/local/emhttp/plugins/{$plugin}/css/openclaw-connect.css")?>">

<div class="occ-log-viewer">
  <h2>Activity Log</h2>

  <div class="occ-log-controls">
    <button type="button" class="occ-btn occ-btn-primary" onclick="occRefreshLog()">Refresh</button>
    <button type="button" class="occ-btn" onclick="occClearLog()">Clear Log</button>
    <label>
      Show last:
      <select id="occ-log-limit" onchange="occRefreshLog()">
        <option value="50">50 entries</option>
        <option value="100" selected>100 entries</option>
        <option value="250">250 entries</option>
        <option value="500">500 entries</option>
      </select>
    </label>
    <label>
      Filter:
      <input type="text" id="occ-log-filter" placeholder="Search..." oninput="occFilterLog()">
    </label>
  </div>

  <table class="tablesorter" id="occ-log-table">
    <thead>
      <tr>
        <th>Time</th>
        <th>Method</th>
        <th>Path</th>
        <th>Resource</th>
        <th>Status</th>
        <th>Duration</th>
        <th>IP</th>
      </tr>
    </thead>
    <tbody id="occ-log-body">
      <tr><td colspan="7"><em>Loading...</em></td></tr>
    </tbody>
  </table>
</div>

<script src="/plugins/<?=$plugin?>/javascript/openclaw-connect.js?v=<?=filemtime("/usr/local/emhttp/plugins/{$plugin}/javascript/openclaw-connect.js")?>"></script>
<script>
OCC_CSRF = '<?=$_SERVER['HTTP_CSRF_TOKEN'] ?? ''?>';
document.addEventListener('DOMContentLoaded', function() {
  occRefreshLog();
});
</script>
